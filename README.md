
# مولّد القصص المرئية بالذكاء الاصطناعي

هذا المشروع هو عبارة عن نظام متكامل يعمل كخط أنابيب (Pipeline) متقدم، مصمم لتحويل الأفكار النصية المجردة إلى أصول مرئية متكاملة (صور وفيديوهات قصيرة). النظام مؤتمت بالكامل ويعتمد على سلسلة من نماذج الذكاء الاصطناعي التوليدية (Gemini) لتنفيذ كل مرحلة من مراحل العملية الإبداعية، مع فرض تدفق عمل صارم لضمان أعلى مستويات الجودة والاتساق البصري في النتيجة النهائية.

---

## المميزات والقدرات الأساسية

### 1. إدارة المشاريع ومفاتيح API المتقدمة
- **إدارة المشاريع:** يوفر التطبيق واجهة مركزية لإدارة المشاريع، مع حفظ تلقائي ودائم في المتصفح لضمان عدم فقدان أي عمل.
- **دعم مفاتيح API متعددة:** يمكنك إدخال قائمة من مفاتيح API. سيقوم النظام بالتبديل بينها تلقائيًا عند استنفاد حصة أحد المفاتيح، مما يضمن استمرارية العمل دون انقطاع.

### 2. تدفق عمل إرشادي مع تحكم إبداعي كامل
يفرض النظام مسارًا منطقيًا من ثلاث مراحل، مع توفير المرونة للمستخدم للتحكم في النتائج:
1.  **المرحلة الأولى: تفاصيل القصة:** أدخل فكرتك الأساسية، المدة، ونسبة الأبعاد.
2.  **المرحلة الثانية: بناء العالم البصري:** يتم توليد أوصاف وصور للشخصيات والمواقع. **يجب** إنشاء هذه الصور قبل الانتقال للمرحلة التالية لضمان الاتساق.
3.  **المرحلة الثالثة: توليد المشاهد:**
    -   **توليد البرومبتات:** يقوم النظام بتوليد برومبتات مخصصة للصور والفيديوهات لكل مشهد.
    -   **تحرير يدوي:** **(ميزة جديدة)** يمكنك الآن تعديل أي برومبت تم إنشاؤه يدويًا قبل توليد الصورة أو الفيديو، مما يمنحك تحكمًا دقيقًا في المخرجات الإبداعية.

### 3. آلية ضمان الاتساق البصري (Visual Coherence Engine)
- **التجسيد البصري الإلزامي:** إجبار المستخدم على توليد صور للشخصيات والمواقع أولاً ينشئ "مرجعًا بصريًا حقيقيًا" وثابتًا.
- **التغذية البصرية المباشرة:** عند توليد برومبتات المشاهد، لا يعتمد النظام على الأوصاف النصية فقط، بل يرسل **الصور الفعلية** للشخصيات والمواقع إلى النموذج، مما يجبره على "رؤية" شكلها وضمان تطابق الأوصاف مع المراجع الأصلية.

### 4. خط أنابيب التوليد المتقدم (Multi-Stage Generation Pipeline)
- **توليد الأصول الأساسية:** يستخدم `gemini-2.5-flash` لتحليل الفكرة وتوليد أوصاف الشخصيات والمواقع.
- **توليد الصور:** يستخدم `imagen-4.0-generate-001` لتحويل الأوصاف إلى صور ثابتة عالية الجودة.
- **توليد الفيديو (Image-to-Video):** يستخدم `veo-2.0-generate-001` لتحريك الصور بناءً على برومبتات الفيديو.
- **دمج الفيديو النهائي:** **(ميزة جديدة)** باستخدام `FFmpeg.wasm` مباشرة في المتصفح، يمكنك دمج جميع مقاطع الفيديو القصيرة التي تم إنشاؤها في ملف فيديو واحد نهائي يمثل القصة الكاملة.

### 5. إدارة المهام وتصدير الأصول
- **معالجة غير متزامنة:** يعرض النظام رسائل مطمئنة أثناء عمليات التوليد الطويلة مثل إنشاء الفيديو.
- **معالجة الأخطاء المتقدمة:** تم تحسين معالجة الأخطاء لتوفير رسائل واضحة ومفيدة.
- **ملاحظات مرئية للتحميل:** **(ميزة جديدة)** تظهر مؤشرات تحميل عند تنزيل الملفات لتعزيز تجربة المستخدم.
- **التحميل المجمع والفردي:** يمكنك تحميل كل أصل على حدة، أو تنزيل جميع الأصول المرئية دفعة واحدة.

## كيفية تشغيل المشروع محليًا

1.  **استنساخ المستودع:**
    ```bash
    git clone <repository-url>
    cd <repository-directory>
    ```

2.  **تثبيت الاعتماديات:**
    (لا توجد اعتماديات خارجية لتثبيتها حيث يتم استيراد المكتبات عبر `importmap` في `index.html`).

3.  **إعداد مفاتيح API:**
    يتطلب المشروع مفاتيح Google AI API. عند تشغيل التطبيق، ستظهر نافذة تطلب منك إدخال مفاتيحك (يمكن إدخال مفتاح واحد أو أكثر، كل مفتاح في سطر). سيتم حفظها في التخزين المحلي للمتصفح.
    
4.  **تشغيل خادم تطوير:**
    استخدم خادم ويب بسيط لخدمة الملفات. على سبيل المثال، باستخدام Python:
    ```bash
    python -m http.server
    ```
    أو باستخدام `live-server` في VS Code.

## الميزات المستقبلية المقترحة
- **تجميع الفيديو النهائي:** إضافة خطوة أخيرة اختيارية تقوم بدمج جميع مقاطع الفيديو القصيرة التي تم إنشاؤها في ملف فيديو واحد يمثل القصة الكاملة، باستخدام مكتبة مثل `FFmpeg.wasm`.
- **إضافة طبقة صوتية:**
    -   **موسيقى تصويرية:** السماح للمستخدم برفع ملف صوتي لاستخدامه كخلفية موسيقية.
    -   **تعليق صوتي:** دمج خدمة تحويل النص إلى كلام (Text-to-Speech) لإنشاء تعليق صوتي لكل مشهد.
- **تصدير واستيراد المشاريع:** إضافة وظيفة لتصدير بيانات المشروع بالكامل كملف JSON، واستيرادها لاحقًا، مما يسمح للمستخدمين بمشاركة مشاريعهم أو الاحتفاظ بنسخ احتياطية منها.